{"ast":null,"code":"import { getApeMyTaskList, saveApeArticle } from '../../api/api';\nimport { mixin } from '../../minix/index';\nimport headerPage from \"../../components/header/header\";\nimport bottomPage from \"../../components/bottom/bottom\";\nexport default {\n  mixins: [mixin],\n  data() {\n    return {\n      task: [],\n      form: {\n        articleDesc: \"\",\n        content: \"\",\n        title: \"\",\n        taskId: \"\",\n        state: 2\n      },\n      editorOption: {\n        placeholder: \"请输入文字内容\",\n        modules: {\n          toolbar: {\n            container: [[\"bold\", \"italic\", \"underline\", \"strike\"], [\"blockquote\", \"code-block\"], [{\n              header: 1\n            }, {\n              header: 2\n            }], [{\n              list: \"ordered\"\n            }, {\n              list: \"bullet\"\n            }], [{\n              script: \"sub\"\n            }, {\n              script: \"super\"\n            }], [{\n              indent: \"-1\"\n            }, {\n              indent: \"+1\"\n            }], [{\n              direction: \"rtl\"\n            }], [{\n              size: [\"small\", false, \"large\", \"huge\"]\n            }], [{\n              header: [1, 2, 3, 4, 5, 6, false]\n            }], [{\n              color: []\n            }, {\n              background: []\n            }], [{\n              font: []\n            }], [{\n              align: []\n            }], [\"clean\"], [\"image\"]],\n            handlers: {\n              'image': function (value) {\n                if (value) {\n                  // 触发上传插件\n                  document.querySelector('.Quill-uploader .el-upload__input').click();\n                } else {\n                  this.quill.format('image', false);\n                }\n              }\n            }\n          },\n          syntax: {\n            highlight: text => {\n              return hljs.highlightAuto(text).value; // 这里就是代码高亮需要配置的地方 \n            }\n          }\n        }\n      }\n    };\n  },\n  components: {\n    headerPage,\n    bottomPage\n  },\n  methods: {\n    getApeMyTaskList() {\n      var param = {\n        state: 0\n      };\n      getApeMyTaskList(param).then(res => {\n        if (res.code == 1000) {\n          this.task = res.data;\n        }\n      });\n    },\n    submit() {\n      if (!this.form.title) {\n        this.$message({\n          message: '请输入笔记标题',\n          type: 'warning'\n        });\n        return;\n      }\n      if (!this.form.content) {\n        this.$message({\n          message: '请输入笔记内容',\n          type: 'warning'\n        });\n        return;\n      }\n      if (!this.form.articleDesc) {\n        this.$message({\n          message: '请输入笔记摘要',\n          type: 'warning'\n        });\n        return;\n      }\n      if (!this.form.taskId) {\n        this.$message({\n          message: '请选择所属课程',\n          type: 'warning'\n        });\n        return;\n      }\n      saveApeArticle(this.form).then(res => {\n        if (res.code == 1000) {\n          this.$message({\n            message: '发布成功，请等待管理员审核',\n            type: 'success'\n          });\n        }\n        this.form = {\n          articleDesc: \"\",\n          content: \"\",\n          title: \"\",\n          taskId: \"\",\n          state: 2\n        };\n      });\n    },\n    handleQillSuccess(res) {\n      let _this = this;\n      if (res.code == 1000) {\n        _this.$notify({\n          title: '上传成功',\n          type: 'success'\n        });\n        let imgurl = this.$store.state.HOST + res.message;\n        let quill = this.$refs.myQuillEditor.quill;\n        let position = quill.getSelection().index;\n        quill.insertEmbed(position, 'image', imgurl);\n        quill.setSelection(position + 1);\n      } else {\n        _this.$notify({\n          title: '上传失败',\n          type: 'error'\n        });\n      }\n    }\n  },\n  created() {},\n  mounted() {\n    this.getApeMyTaskList();\n  }\n};","map":{"version":3,"names":["getApeMyTaskList","saveApeArticle","mixin","headerPage","bottomPage","mixins","data","task","form","articleDesc","content","title","taskId","state","editorOption","placeholder","modules","toolbar","container","header","list","script","indent","direction","size","color","background","font","align","handlers","image","value","document","querySelector","click","quill","format","syntax","highlight","text","hljs","highlightAuto","components","methods","param","then","res","code","submit","$message","message","type","handleQillSuccess","_this","$notify","imgurl","$store","HOST","$refs","myQuillEditor","position","getSelection","index","insertEmbed","setSelection","created","mounted"],"sources":["src/views/article/addArticle.vue"],"sourcesContent":["<template>\r\n  <div class=\"addArticle\">\r\n    <headerPage></headerPage>\r\n    <div class=\"addArticle-content\">\r\n        <div class=\"addArticle-form\">\r\n            <div class=\"addArticle-title\">\r\n                 记笔记\r\n            </div>\r\n            <div class=\"addArticle-list\">\r\n                <div class=\"addArticle-item\">\r\n                    <div style=\"margin-top:10px;margin-left:10px\">标题</div>\r\n                    <div style=\"margin-top:10px;margin-left:10px;margin-bottom:10px\">\r\n                        <el-input size=\"mini\" v-model=\"form.title\" placeholder=\"请输入笔记标题\"></el-input>\r\n                    </div>\r\n                </div>\r\n                <div class=\"addArticle-item\">\r\n                    <div style=\"margin-top:10px;margin-left:10px\">所属课程</div>\r\n                    <div style=\"margin-top:10px;margin-left:10px;margin-bottom:10px\">\r\n                        <el-select size=\"mini\" v-model=\"form.taskId\">\r\n                            <el-option v-for=\"(item,index) in task\" :label=\"item.taskName\" :value=\"item.taskId\"></el-option>\r\n                        </el-select>\r\n                    </div>\r\n                </div>\r\n                <div class=\"addArticle-item\">\r\n                    <div style=\"margin-top:10px;margin-left:10px\">摘要</div>\r\n                    <div style=\"margin-top:10px;margin-left:10px;margin-bottom:10px\">\r\n                         <el-input type=\"textarea\" rows=5 v-model=\"form.articleDesc\" size=\"mini\" placeholder=\"请输入笔记摘要\"></el-input>\r\n                    </div>\r\n                </div>\r\n                <div class=\"addArticle-item\" style=\"height:600px\">\r\n                    <div style=\"margin-top:10px;margin-left:10px\">内容</div>\r\n                    <div style=\"margin-top:10px;margin-left:10px;margin-bottom:10px\">\r\n                        <quill-editor style=\"height:450px\" ref=\"myQuillEditor\" :options=\"editorOption\"\r\n                        v-model=\"form.content\"/>\r\n                        <el-upload class=\"Quill-uploader\" :show-file-list=\"false\" accept=\"image/*\" v-show=\"0\" ref=\"updateUpload\" :multiple=\"false\" :action=\"uploadImageUrl()\"\r\n                            :on-success=\"handleQillSuccess\">\r\n                        </el-upload>\r\n                    </div>\r\n                </div>\r\n                <div style=\"margin-bottom:20px\">\r\n                    <el-button @click=\"submit\" size=\"mini\" type=\"primary\">提交</el-button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <bottomPage></bottomPage>\r\n  </div>\r\n</template>\r\n\r\n<script> \r\n  import {getApeMyTaskList,saveApeArticle} from '../../api/api' \r\n  import { mixin } from '../../minix/index';\r\n  import headerPage from \"../../components/header/header\"\r\n  import bottomPage from \"../../components/bottom/bottom\"\r\n  export default {\r\n    mixins: [mixin],\r\n    data() {\r\n      return{\r\n        task: [],\r\n        form: {\r\n            articleDesc: \"\",\r\n            content: \"\",\r\n            title: \"\",\r\n            taskId: \"\",\r\n            state: 2\r\n        },\r\n        editorOption: {\r\n          placeholder: \"请输入文字内容\",\r\n          modules: { \r\n            toolbar: {\r\n                container: [\r\n                    [\"bold\", \"italic\", \"underline\", \"strike\"], \r\n                    [\"blockquote\", \"code-block\"], \r\n                    [{ header: 1 }, { header: 2 }], \r\n                    [{ list: \"ordered\" }, { list: \"bullet\" }], \r\n                    [{ script: \"sub\" }, { script: \"super\" }], \r\n                    [{ indent: \"-1\" }, { indent: \"+1\" }], \r\n                    [{ direction: \"rtl\" }], \r\n                    [{ size: [\"small\", false, \"large\", \"huge\"] }], \r\n                    [{ header: [1, 2, 3, 4, 5, 6, false] }], \r\n                    [{ color: [] }, { background: [] }], \r\n                    [{ font: [] }], [{ align: [] }], \r\n                    [\"clean\"], [\"image\"]\r\n                ],\r\n                handlers: {\r\n                    'image': function ( value ) {\r\n                        if ( value ) {\r\n                            // 触发上传插件\r\n                            document.querySelector('.Quill-uploader .el-upload__input').click()\r\n                        } else {\r\n                            this.quill.format( 'image', false );\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            syntax: { \r\n                highlight: text => { \r\n                    return hljs.highlightAuto(text).value; // 这里就是代码高亮需要配置的地方 \r\n                }\r\n            }\r\n          }\r\n        },\r\n      }\r\n    },\r\n    components: {\r\n      headerPage,\r\n      bottomPage\r\n    },\r\n    methods: {\r\n        getApeMyTaskList() {\r\n            var param = {\r\n                state: 0\r\n            }\r\n            getApeMyTaskList(param).then(res => {\r\n                if (res.code == 1000) {\r\n                    this.task = res.data\r\n                }\r\n            })\r\n        },\r\n        submit() {\r\n            if (!this.form.title) {\r\n                this.$message({\r\n                    message: '请输入笔记标题',\r\n                    type: 'warning'\r\n                })\r\n                return\r\n            }\r\n            if (!this.form.content) {\r\n                this.$message({\r\n                    message: '请输入笔记内容',\r\n                    type: 'warning'\r\n                })\r\n                return\r\n            }\r\n            if (!this.form.articleDesc) {\r\n                this.$message({\r\n                    message: '请输入笔记摘要',\r\n                    type: 'warning'\r\n                })\r\n                return\r\n            }\r\n            if (!this.form.taskId) {\r\n                this.$message({\r\n                    message: '请选择所属课程',\r\n                    type: 'warning'\r\n                })\r\n                return\r\n            }\r\n            saveApeArticle(this.form).then(res => {\r\n                if(res.code == 1000) {\r\n                    this.$message({\r\n                        message: '发布成功，请等待管理员审核',\r\n                        type: 'success'\r\n                    })\r\n                }\r\n                this.form = {\r\n                    articleDesc: \"\",\r\n                    content: \"\",\r\n                    title: \"\",\r\n                    taskId: \"\",\r\n                    state: 2\r\n                }\r\n            })\r\n        },\r\n        handleQillSuccess(res){\r\n            let _this = this;\r\n            if(res.code == 1000){\r\n                _this.$notify({\r\n                    title: '上传成功',\r\n                    type: 'success'\r\n                });\r\n                let imgurl = this.$store.state.HOST + res.message\r\n                let quill = this.$refs.myQuillEditor.quill\r\n                let position = quill.getSelection().index\r\n                quill.insertEmbed(position, 'image', imgurl)\r\n                quill.setSelection(position + 1)\r\n            }else{\r\n                _this.$notify({\r\n                    title: '上传失败',\r\n                    type: 'error'\r\n                });\r\n            }\r\n        },\r\n    },\r\n    created() {\r\n     \r\n    },\r\n    mounted() {\r\n      this.getApeMyTaskList()\r\n    }\r\n }\r\n</script>\r\n\r\n<style scoped>\r\n  @import url(\"../../assets/css/article/addArticle.css\");\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}